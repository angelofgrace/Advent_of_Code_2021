using System;
using System.Net;
using System.IO;
using System.Collections.Generic;

namespace Advent_of_Code_2021
{
    class SonarSweep
    {

        static void Main(string[] args)
        {
            // In an effort to discern how quickly the sea floor drops off extending out from the submarine,
            // we compare subsequent depth measurements and identify the frequency of descending results

            string sonarDataUnparsed;

            // web scraper version: CURRENTLY 400 BAD REQUEST
            // sonarDataUnparsed = Web_Request_Get("https://adventofcode.com/2021/day/1/input");

            // data hard input version:
            sonarDataUnparsed = "198\n208\n209\n212\n213\n217\n218\n223\n222\n224\n216\n233\n238\n239\n240\n250\n263\n264\n267\n274\n288\n316\n319\n330\n340\n347\n349\n354\n350\n349\n351\n352\n353\n371\n383\n385\n405\n413\n455\n451\n459\n458\n459\n461\n463\n475\n480\n486\n489\n497\n502\n512\n513\n516\n517\n528\n559\n560\n558\n565\n566\n567\n571\n573\n574\n582\n583\n585\n589\n597\n608\n607\n614\n619\n608\n624\n665\n666\n675\n695\n698\n703\n711\n733\n738\n739\n742\n743\n763\n775\n778\n804\n806\n810\n812\n818\n819\n828\n867\n866\n876\n878\n881\n875\n881\n858\n859\n868\n869\n860\n888\n890\n891\n893\n894\n919\n924\n925\n933\n937\n950\n955\n966\n984\n989\n993\n996\n997\n1015\n1031\n1035\n1039\n1055\n1057\n1058\n1059\n1060\n1061\n1067\n1069\n1070\n1059\n1060\n1077\n1079\n1078\n1080\n1087\n1088\n1090\n1097\n1082\n1102\n1105\n1106\n1120\n1125\n1130\n1132\n1154\n1141\n1135\n1131\n1133\n1134\n1137\n1138\n1141\n1142\n1143\n1166\n1175\n1193\n1201\n1236\n1238\n1234\n1240\n1242\n1243\n1271\n1276\n1277\n1272\n1286\n1288\n1290\n1292\n1317\n1341\n1361\n1363\n1375\n1376\n1377\n1383\n1387\n1390\n1402\n1404\n1412\n1418\n1426\n1429\n1466\n1480\n1483\n1478\n1484\n1486\n1488\n1491\n1486\n1489\n1492\n1517\n1520\n1523\n1539\n1546\n1551\n1521\n1517\n1518\n1522\n1525\n1526\n1539\n1540\n1544\n1545\n1561\n1571\n1572\n1574\n1575\n1568\n1573\n1587\n1588\n1600\n1603\n1627\n1629\n1633\n1645\n1670\n1671\n1685\n1690\n1696\n1698\n1703\n1698\n1699\n1702\n1714\n1716\n1709\n1738\n1753\n1761\n1766\n1769\n1772\n1761\n1763\n1774\n1781\n1782\n1799\n1802\n1816\n1818\n1819\n1805\n1810\n1817\n1819\n1831\n1834\n1835\n1852\n1855\n1858\n1859\n1856\n1857\n1868\n1885\n1891\n1893\n1890\n1891\n1892\n1893\n1896\n1911\n1912\n1914\n1916\n1914\n1918\n1930\n1932\n1958\n1966\n1976\n1982\n1985\n1986\n1987\n1992\n1997\n2031\n2041\n2042\n2044\n2058\n2060\n2075\n2073\n2084\n2087\n2090\n2125\n2128\n2129\n2130\n2131\n2136\n2137\n2145\n2150\n2152\n2155\n2161\n2162\n2165\n2167\n2189\n2197\n2199\n2214\n2226\n2233\n2234\n2241\n2242\n2256\n2259\n2263\n2257\n2267\n2270\n2269\n2272\n2273\n2275\n2279\n2284\n2285\n2266\n2271\n2287\n2291\n2310\n2313\n2314\n2317\n2311\n2312\n2311\n2312\n2326\n2331\n2332\n2338\n2340\n2352\n2355\n2360\n2361\n2357\n2371\n2384\n2380\n2392\n2393\n2396\n2397\n2400\n2417\n2420\n2421\n2422\n2444\n2457\n2458\n2464\n2467\n2494\n2495\n2498\n2510\n2514\n2521\n2526\n2525\n2533\n2536\n2547\n2544\n2547\n2556\n2557\n2558\n2561\n2570\n2571\n2573\n2575\n2583\n2584\n2585\n2572\n2574\n2575\n2587\n2589\n2590\n2602\n2603\n2604\n2605\n2589\n2603\n2608\n2611\n2616\n2613\n2617\n2618\n2619\n2628\n2629\n2630\n2631\n2639\n2645\n2649\n2657\n2665\n2673\n2680\n2679\n2680\n2702\n2703\n2709\n2711\n2714\n2715\n2716\n2715\n2721\n2720\n2739\n2745\n2748\n2752\n2749\n2748\n2749\n2751\n2752\n2750\n2760\n2777\n2778\n2779\n2780\n2787\n2800\n2805\n2810\n2812\n2820\n2821\n2843\n2846\n2853\n2862\n2861\n2867\n2880\n2890\n2891\n2892\n2885\n2887\n2890\n2894\n2897\n2925\n2926\n2931\n2933\n2940\n2943\n2941\n2959\n2971\n2982\n2984\n3002\n3006\n3008\n3012\n3013\n3034\n3043\n3059\n3063\n3064\n3060\n3075\n3090\n3091\n3104\n3108\n3114\n3117\n3106\n3104\n3110\n3113\n3114\n3126\n3119\n3138\n3140\n3141\n3143\n3139\n3145\n3147\n3153\n3161\n3170\n3168\n3180\n3181\n3177\n3196\n3210\n3216\n3232\n3233\n3234\n3235\n3239\n3240\n3242\n3243\n3244\n3243\n3248\n3249\n3275\n3276\n3278\n3280\n3286\n3291\n3293\n3294\n3301\n3310\n3319\n3326\n3338\n3339\n3348\n3366\n3376\n3371\n3372\n3404\n3407\n3408\n3425\n3444\n3451\n3457\n3452\n3459\n3468\n3491\n3475\n3476\n3481\n3505\n3516\n3519\n3542\n3543\n3541\n3542\n3541\n3551\n3553\n3552\n3533\n3542\n3543\n3561\n3562\n3563\n3566\n3571\n3572\n3596\n3600\n3603\n3607\n3608\n3609\n3613\n3654\n3665\n3672\n3661\n3662\n3663\n3670\n3676\n3683\n3707\n3709\n3714\n3717\n3709\n3710\n3713\n3714\n3715\n3716\n3735\n3749\n3763\n3770\n3784\n3782\n3786\n3790\n3792\n3794\n3803\n3805\n3819\n3823\n3826\n3828\n3838\n3839\n3843\n3870\n3877\n3888\n3889\n3891\n3892\n3893\n3894\n3880\n3860\n3878\n3880\n3888\n3893\n3898\n3904\n3906\n3907\n3910\n3918\n3927\n3946\n3973\n3982\n3979\n3980\n3993\n3984\n3988\n3986\n3987\n3988\n3989\n3997\n4000\n4001\n4025\n4030\n4034\n4038\n4040\n4044\n4046\n4048\n4057\n4067\n4079\n4092\n4094\n4122\n4124\n4128\n4127\n4128\n4132\n4136\n4141\n4146\n4151\n4153\n4163\n4167\n4168\n4170\n4172\n4176\n4177\n4178\n4194\n4198\n4199\n4201\n4203\n4204\n4205\n4204\n4209\n4211\n4213\n4224\n4240\n4242\n4255\n4266\n4280\n4284\n4295\n4310\n4323\n4343\n4351\n4359\n4383\n4387\n4388\n4397\n4401\n4403\n4404\n4405\n4425\n4431\n4435\n4439\n4444\n4452\n4461\n4470\n4466\n4467\n4469\n4481\n4482\n4498\n4496\n4504\n4505\n4512\n4518\n4520\n4521\n4523\n4534\n4516\n4527\n4525\n4534\n4535\n4551\n4565\n4570\n4571\n4578\n4584\n4595\n4609\n4610\n4618\n4628\n4629\n4630\n4634\n4636\n4637\n4640\n4659\n4664\n4669\n4665\n4673\n4687\n4688\n4693\n4694\n4697\n4667\n4678\n4679\n4702\n4707\n4706\n4709\n4711\n4718\n4725\n4716\n4718\n4723\n4724\n4726\n4727\n4729\n4735\n4736\n4738\n4739\n4758\n4763\n4773\n4774\n4776\n4777\n4778\n4777\n4785\n4786\n4771\n4773\n4774\n4777\n4781\n4783\n4788\n4791\n4794\n4807\n4816\n4818\n4825\n4828\n4838\n4822\n4831\n4837\n4841\n4851\n4854\n4870\n4876\n4888\n4889\n4900\n4906\n4909\n4910\n4917\n4919\n4920\n4926\n4928\n4934\n4941\n4943\n4945\n4948\n4950\n4956\n4951\n4948\n4954\n4958\n4960\n4959\n4962\n4969\n4982\n4986\n4994\n5000\n5009\n5027\n5025\n5029\n5033\n5037\n5036\n5037\n5040\n5032\n5033\n5034\n5039\n5045\n5050\n5045\n5076\n5077\n5082\n5083\n5106\n5107\n5114\n5117\n5137\n5138\n5143\n5147\n5153\n5156\n5171\n5182\n5183\n5184\n5185\n5189\n5182\n5189\n5194\n5201\n5205\n5213\n5218\n5221\n5223\n5230\n5231\n5243\n5255\n5230\n5228\n5237\n5245\n5248\n5259\n5260\n5272\n5278\n5281\n5287\n5286\n5287\n5298\n5328\n5329\n5333\n5335\n5337\n5339\n5341\n5346\n5349\n5350\n5351\n5358\n5359\n5360\n5374\n5376\n5359\n5360\n5388\n5401\n5406\n5410\n5412\n5413\n5414\n5415\n5435\n5436\n5441\n5443\n5448\n5446\n5448\n5449\n5464\n5465\n5466\n5469\n5470\n5492\n5493\n5494\n5509\n5520\n5528\n5530\n5537\n5541\n5542\n5559\n5562\n5563\n5588\n5595\n5596\n5601\n5618\n5626\n5627\n5641\n5667\n5679\n5685\n5693\n5695\n5717\n5733\n5734\n5754\n5755\n5757\n5758\n5759\n5760\n5761\n5771\n5774\n5780\n5784\n5785\n5787\n5788\n5790\n5800\n5811\n5814\n5810\n5811\n5794\n5792\n5803\n5804\n5812\n5814\n5815\n5836\n5852\n5853\n5855\n5878\n5879\n5880\n5883\n5889\n5897\n5911\n5932\n5934\n5935\n5936\n5938\n5939\n5941\n5951\n5955\n5950\n5951\n5954\n5970\n5971\n5974\n5977\n5978\n5985\n5986\n6013\n6024\n6031\n6037\n6043\n6052\n6051\n6053\n6076\n6096\n6101\n6106\n6108\n6115\n6125\n6106\n6107\n6104\n6114\n6142\n6143\n6162\n6169\n6170\n6171\n6181\n6198\n6199\n6202\n6206\n6207\n6244\n6246\n6249\n6250\n6254\n6264\n6271\n6276\n6277\n6268\n6271\n6288\n6293\n6308\n6309\n6326\n6341\n6345\n6344\n6341\n6364\n6365\n6366\n6370\n6371\n6373\n6376\n6377\n6378\n6377\n6379\n6386\n6396\n6397\n6420\n6422\n6429\n6433\n6463\n6472\n6473\n6490\n6491\n6492\n6497\n6522\n6523\n6524\n6519\n6520\n6521\n6525\n6530\n6531\n6534\n6535\n6543\n6552\n6558\n6584\n6586\n6587\n6588\n6606\n6614\n6618\n6646\n6650\n6651\n6654\n6677\n6663\n6665\n6676\n6655\n6653\n6655\n6665\n6667\n6682\n6692\n6703\n6704\n6707\n6715\n6719\n6730\n6731\n6733\n6743\n6747\n6748\n6750\n6759\n6771\n6772\n6776\n6775\n6776\n6782\n6785\n6812\n6841\n6858\n6860\n6859\n6877\n6886\n6895\n6914\n6919\n6922\n6924\n6933\n6935\n6936\n6937\n6938\n6952\n6962\n6965\n6984\n6987\n6986\n6985\n6977\n6967\n6968\n6966\n6980\n6997\n6994\n7002\n7008\n7000\n6975\n7009\n7014\n7015\n7026\n7027\n7034\n7036\n7041\n7040\n7041\n7045\n7048\n7065\n7074\n7075\n7082\n7087\n7092\n7098\n7097\n7111\n7127\n7124\n7135\n7136\n7137\n7140\n7153\n7156\n7158\n7174\n7176\n7177\n7163\n7166\n7159\n7157\n7158\n7164\n7165\n7172\n7190\n7194\n7199\n7200\n7205\n7208\n7207\n7222\n7227\n7244\n7249\n7271\n7272\n7273\n7274\n7281\n7286\n7288\n7314\n7315\n7317\n7318\n7319\n7304\n7307\n7308\n7309\n7312\n7319\n7322\n7337\n7338\n7345\n7346\n7350\n7360\n7361\n7362\n7360\n7395\n7400\n7404\n7405\n7407\n7406\n7411\n7420\n7435\n7440\n7442\n7446\n7453\n7446\n7448\n7467\n7471\n7469\n7470\n7482\n7485\n7492\n7488\n7489\n7492\n7493\n7494\n7497\n7504\n7520\n7525\n7547\n7554\n7543\n7553\n7560\n7561\n7577\n7589\n7591\n7593\n7587\n7596\n7597\n7584\n7590\n7591\n7599\n7626\n7627\n7628\n7630\n7645\n7639\n7645\n7652\n7657\n7662\n7664\n7674\n7680\n7681\n7694\n7698\n7716\n7704\n7705\n7706\n7708\n7712\n7716\n7715\n7717\n7722\n7723\n7728\n7721\n7722\n7724\n7727\n7735\n7737\n7725\n7746\n7747\n7750\n7761\n7762\n7765\n7777\n7780\n7776\n7777\n7778\n7759\n7769\n7770\n7787\n7797\n7798\n7804\n7803\n7804\n7805\n7811\n7825\n7824\n7826\n7827\n7828\n7851\n7867\n7887\n7889\n7890\n7900\n7904\n7917\n7918\n7935\n7941\n7942\n7946\n7947\n7948\n7949\n7976\n7979\n7981\n7983\n7988\n7999\n8000\n8009\n8011\n8012\n8019\n8021\n8025\n8027\n8006\n8011\n8034\n8036\n8037\n8038\n8013\n8024\n8029\n8032\n8033\n8034\n8032\n8034\n8036\n8059\n8060\n8063\n8064\n8081\n8090\n8097\n8122\n8135\n8147\n8149\n8150\n8151\n8162\n8174\n8154\n8158\n8162\n8170\n8171\n8188\n8189\n8190\n8191\n8196\n8205\n8216\n8217\n8222\n8233\n8239\n8240\n8242\n8257\n8249\n8262\n8264\n8274\n8309\n8311\n8328\n8333\n8335\n8338\n8344\n8350\n8349\n8350\n8363\n8366\n8370\n8371\n8395\n8398\n8401\n8410\n8425\n8429\n8430\n8441\n8443\n8445\n8451\n8452\n8455\n8458\n8431\n8443\n8453\n8459\n8477\n8474\n8479\n8476\n8487\n8488\n8489\n8500\n8501\n8503\n8504\n8538\n8523\n8529\n8530\n8556\n8573\n8576\n8589\n8595\n8624\n8632\n8634\n8628\n8636\n8635\n8636\n8644\n8659\n8661\n8641\n8652\n8659\n8650\n8664\n8667\n8674\n8676\n8678\n8686\n8696\n8697\n8735\n8740\n8749\n8767\n8769\n8747\n8751\n8760\n8755\n8766\n8768\n8777\n8782\n8788\n8796\n8799\n8801\n8809\n8807\n8816\n8827\n8831\n8835\n8836\n8843\n8844\n8845\n8851\n8858\n8860\n8862\n8863\n8889\n8891\n8912\n8913\n8924\n8928\n8929\n8939\n8955\n8957\n8958\n8963\n8988\n8989\n8997\n8995\n8999\n8968\n8990\n8991\n8992\n8994\n8996\n9013\n9024\n9026\n9035\n9046\n9047\n9083\n9084\n9089\n9096\n9108\n9107\n9116\n9123\n9122\n9128\n9132\n9151\n9155\n9163\n9174\n9178\n9183\n9199\n9209\n9217\n9219\n9232\n9233\n9232\n9237\n9241\n9244\n9245\n9247\n9251\n9252\n9266\n9285\n9284\n9291\n9294\n9295\n9296\n9300\n9322\n9328\n9333\n9337\n9345\n9346\n9347\n9371\n9375\n9394\n9397\n9404\n9406\n9422\n9425\n9438\n9440\n9435\n9442\n9455\n9473\n9475\n9496\n9499\n9500\n9511\n9512\n9513\n9539\n9540\n9543\n9547\n9550\n9557\n9571\n9577\n9593\n9600\n9609\n9615\n9620\n9621\n9616\n9625\n9626\n9637\n9638\n9642\n9648\n9656\n9654\n9661\n9665\n9696\n9705\n9710\n9719\n9720\n9717\n9718\n9717\n9719\n9724\n9725\n9738\n9741\n9743\n9744\n9745\n9765\n9778\n9779\n9789\n9791\n9773\n9778\n9780\n9782\n9783\n9782\n9797\n9799\n9800\n9801\n9823\n9824\n9834\n9836\n9841\n9845\n9847\n9865\n9868\n9883\n9884\n9887\n9890\n9892\n9899\n9908\n9910\n9911\n9915\n9918\n9922\n9926\n9923\n9944\n9947\n9948\n9949\n9958\n9959\n9961\n9973\n9954\n9976\n9978\n10001\n10000\n9992\n9997\n9985\n9995\n9996\n10005\n9999\n10001\n10002\n10009\n10041\n10045\n10051\n10070\n10071\n10073\n10100\n10099\n10100\n10101\n10102\n10105\n10082\n10083\n10082\n10086\n10112\n10113\n10114\n10122\n10124\n10127\n10140\n10156\n10157\n10158\n10159\n10162\n10163\n10166\n10177\n10178\n10180\n10178\n10179\n10191\n10186\n10198\n10201\n10204\n10227\n10229\n10232\n10234\n10246\n10247\n10248\n10249\n10250\n10269\n10277\n10278\n10279\n10289\n10291\n10294\n10292\n10304\n10324\n10339\n10342\n10343\n10349\n10354\n10371\n10370\n10374\n10376\n10379\n10405\n10406\n10405\n10403\n10411\n10412\n10411\n10419\n10422\n10435\n10437\n10438\n10437\n10440\n10427\n10421\n10432\n10434\n10439\n10449\n10442\n10469\n10471\n10476\n10480\n10481\n10485\n10507\n10508\n10511\n10512\n10513\n10523\n10524\n10529\n10536\n10552\n10563\n10569\n10573\n10575\n10576\n10578\n10596\n10602\n10630\n10647\n10657\n10659\n10684\n10687\n10692\n10693\n10700\n10702\n10703\n10709\n10714\n10716\n10727\n10746\n10744\n10754\n10753\n10754\n10755\n10759\n10763\n10764\n10765\n10769\n10770\n10771\n10777\n10796\n10807\n10813\n10818\n10825\n10830\n10835\n10836\n10849\n10858\n10873\n10882\n10879\n10882\n10886\n10902\n10903\n10931\n10930";

            // Store parsed measurements in a list
            List<int> parsedSonarData = ParseSonarData(sonarDataUnparsed);

            // Part 1: Compare individual readings to identify points of descent
            SubsequentMeasurementCompare(parsedSonarData);

            // Part 2: Compare sums of subsequent sliding three-measurement sets to identify trends of descent
            ThreeMeasurementCompare(parsedSonarData);
            
        }

        public static void SubsequentMeasurementCompare(List<int> parsedSonarData)
        {
            // track number of descending readings
            int depthIncreaseCounter = 0;

            for (int i = 0; i < parsedSonarData.Count - 1; i++)
            {
                if (parsedSonarData[i] < parsedSonarData[i + 1])
                    depthIncreaseCounter += 1;
            }

            Console.WriteLine(depthIncreaseCounter);
        }

        public static void ThreeMeasurementCompare (List<int> parsedSonarData)
        {
            // track number of descending trends
            int depthIncreaseCounter = 0;

            for (int i = 0; i < parsedSonarData.Count - 3; i++)
            {
                // by creating the three-measurement sets within the for loop, they slide automatically
                int sumA = parsedSonarData[i] + parsedSonarData[i + 1] + parsedSonarData[i + 2];
                int sumB = parsedSonarData[i + 1] + parsedSonarData[i + 2] + parsedSonarData[i + 3];

                if (sumA < sumB)
                {
                    // an increased sum means a greater depth
                    depthIncreaseCounter += 1;
                }
            }
            Console.WriteLine(depthIncreaseCounter);
        }

        public static string Web_Request_Get(string URL_to_parse)
        {
            // Using WebRequests, pull the data directly from the AdventCode website
            
            // string to store unparsed data outside the using block
            string sonarDataUnparsed;

            WebRequest request = WebRequest.Create(URL_to_parse);
            request.Credentials = CredentialCache.DefaultCredentials;


            WebResponse response = request.GetResponse();
            Console.WriteLine(((HttpWebResponse)response).StatusDescription);

            // Get the stream containing content returned by the server.
            // The using block ensures the stream is automatically closed.
            using (Stream dataStream = response.GetResponseStream())
            {
                //Open the stream using StreamReader
                StreamReader reader = new StreamReader(dataStream);
                //Read web content
                string responseFromServer = reader.ReadToEnd();
                sonarDataUnparsed = responseFromServer;
                //Display the content
                Console.WriteLine(responseFromServer);
            }

            //Close the response
            response.Close();

            return sonarDataUnparsed;
        }

        public static List<int> ParseSonarData(string sonarDataUnparsed)
        {
            // Parse and convert sonar data from a convoluted string to a list of integers

            // Create a list to store the sonar responses
            List<int> parsedSonarData = new List<int>();

            // Split the data using newline as a delimiter
            string[] dataAsStrings = sonarDataUnparsed.Split('\n');

             foreach (string measurement in dataAsStrings)
            {
                // convert to integer
                int temp = Int32.Parse(measurement);
                // add to data list
                parsedSonarData.Add(temp);
            }

            return parsedSonarData;
        }
    }
}
